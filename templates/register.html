{% extends "base.html" %} {% block content %}
<div class="container">
  {% if registration_complete %}
  <h2>Almost Done!</h2>
  <div class="qr-container">
    <p>Scan this QR code with your authenticator app:</p>
    <img src="data:image/png;base64,{{ qr_image }}" alt="QR Code" />
    <p class="info-text">
      You will be redirected to login page in
      <span id="countdown">10</span> seconds...
    </p>
  </div>
  {% else %}
  <h2>Create Account</h2>
  <form method="POST">
    <div class="form-group">
      <label for="username">Username</label>
      <input
        type="text"
        id="username"
        name="username"
        required
        placeholder="Choose a username"
      />
    </div>
    <div class="form-group">
      <label for="password">Password</label>
      <input
        type="password"
        id="password"
        name="password"
        required
        placeholder="Choose a strong password"
      />
    </div>
    <button type="submit">Register</button>
  </form>
  <p class="link-text">
    Already have an account? <a href="{{ url_for('login') }}">Login here</a>
  </p>
  {% endif %}
</div>

{% if registration_complete %}
<script>
  let timeLeft = 10;
  const countdownElement = document.getElementById("countdown");

  const countdown = setInterval(() => {
    timeLeft--;
    countdownElement.textContent = timeLeft;

    if (timeLeft <= 0) {
      clearInterval(countdown);
      window.location.href = "{{ url_for('login') }}";
    }
  }, 1000);
</script>
{% endif %} {% endblock %}
